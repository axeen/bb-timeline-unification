var bannerboy=bannerboy||{};bannerboy.scrubberController={create:function(e){var t=this,n=bannerboy.createElement({background:"#36b1c5",userSelect:"none",bottom:0,width:"100%",minHeight:this.scrubberHeight,position:"fixed",parent:document.body}),i=bannerboy.createElement({background:"#0e2c31",position:"fixed",width:this.controlsWidth,height:this.scrubberHeight*Object.keys(e).length,"float":"left",parent:n});this.playButton=bannerboy.createElement({innerHTML:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="64px" height="64px" viewBox="-90 94 64 64" enable-background="new -90 94 64 64" xml:space="preserve"> <path fill="#E6535E" d="M-81.6,94v64l50.3-32L-81.6,94z"/> </svg>',left:25,top:"50%",yPercent:-50,display:"none",parent:i}),this.pauseButton=bannerboy.createElement({innerHTML:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="64px" height="64px" viewBox="-66 94 64 64" enable-background="new -66 94 64 64" xml:space="preserve"> <path fill="#E6535E" d="M-61.4,158h18.3V94h-18.3V158z M-24.9,94v64h18.3V94H-24.9z"/> </svg>',left:25,top:"50%",yPercent:-50,display:"block",parent:i}),this.playButton.addEventListener("click",function(){t.play()}),this.pauseButton.addEventListener("click",function(){t.pause()}),window.addEventListener("keydown",this.keyboardEvent),window.addEventListener("keyup",this.keyboardEvent);var r=0;for(var s in e)r++,this.scrubbers.push(new bannerboy.Scrubber(s,e[s],r%2?"#206975":"#36b1c5",n));TweenLite.ticker.addEventListener("tick",this.update,this)},update:function(){for(var e=0;e<this.scrubbers.length;e++)this.scrubbers[e].update();for(var t=0,n=0;n<this.scrubbers.length;n++)this.scrubbers[n].timeline.isActive()||t++;t!=this.scrubbers.length||this.paused?t!=this.scrubbers.length&&this.paused&&(this.paused=!1,this.playButton.set({display:"none"}),this.pauseButton.set({display:"block"})):this.pause()},play:function(){this.playButton.set({display:"none"}),this.pauseButton.set({display:"block"});for(var e=0;e<this.scrubbers.length;e++)this.scrubbers[e].timeline.resume();this.paused=!1},pause:function(){this.playButton.set({display:"block"}),this.pauseButton.set({display:"none"});for(var e=0;e<this.scrubbers.length;e++)this.scrubbers[e].timeline.pause();this.paused=!0},togglePlayPause:function(){this.paused?this.play():this.pause()},increaseTime:function(){for(var e=0;e<this.scrubbers.length;e++){var t=this.scrubbers[e].timeline;t.time(t.time()+.1)}},decreaseTime:function(){for(var e=0;e<this.scrubbers.length;e++){var t=this.scrubbers[e].timeline;t.time(t.time()-.1)}},keyboardEvent:function(e){var t=bannerboy.scrubberController;t.keyMap[e.keyCode]="keydown"==e.type,t.keyDown("spacebar")&&t.togglePlayPause(),t.keyDown("left")&&t.decreaseTime(),t.keyDown("right")&&t.increaseTime()},keyDown:function(e){return this.keyMap[this.keyCodes[e]]?!0:void 0},scrubbers:[],playButton:null,pauseButton:null,controlsWidth:140,scrubberHeight:100,paused:!1,keyMap:{},keyCodes:{command:91,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,"*":106,"+":107,"-":109,".":110,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,",":188,spacebar:32}},bannerboy.Scrubber=function(e,t,n,i){var r=this;this.container=bannerboy.createElement({background:n,height:bannerboy.scrubberController.scrubberHeight,position:"static",bottom:0,marginLeft:bannerboy.scrubberController.controlsWidth,parent:i}),this.innerContainer=bannerboy.createElement({width:"100%",height:"100%",position:"relative",parent:this.container}),this.title=bannerboy.createElement({innerHTML:e,fontFamily:"Helvetica Neue",fontWeight:"bold",color:"#FFF",opacity:.1,fontSize:62,letterSpacing:"-1px",left:10,top:10,parent:this.innerContainer}),this.handle=bannerboy.createElement({background:"#e6535e",width:2,height:"100%",parent:this.innerContainer}),this.timeElement=bannerboy.createElement({right:10,bottom:20,fontFamily:"Helvetica Neue",fontWeight:"bold",color:"#FFF",opacity:.2,fontSize:24,letterSpacing:"-1px",lineHeight:"0px",zIndex:10,parent:this.innerContainer}),this.width=parseInt(window.getComputedStyle(this.innerContainer).width),this.timeline=t,this.name=e,this.currentHandlePos=0,this.mouseX=0,this.timeProgress=0,this.dragging=!1,this.settingInterval=!1,this.settingIntervalHead=!1,this.currentMovingIntervalHead=null,this.paused=!1,this.labels=this.timeline._labels,this.labelElements=[],this.children=this.timeline.getChildren(!1),this.childrenElements=[];for(var s in this.labels){var a=bannerboy.createElement({background:"#0e2c31",left:this.width*(this.labels[s]/this.timeline.duration()),width:1,height:"100%",zIndex:10,parent:this.innerContainer});bannerboy.createElement({innerHTML:s,fontFamily:"Helvetica Neue",fontSize:12,padding:2,color:"#FFF",background:"#000",bottom:0,borderRadius:"0 3px 3px 0",parent:a});a.time=this.labels[s],this.labelElements.push(a)}this.playButton=bannerboy.createElement({innerHTML:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="16px" height="16px" viewBox="-90 94 64 64" enable-background="new -90 94 64 64" xml:space="preserve"> <path fill="#E6535E" d="M-81.6,94v64l50.3-32L-81.6,94z"/> </svg>',left:-25,top:25,display:"none",parent:this.innerContainer}),this.pauseButton=bannerboy.createElement({innerHTML:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="16px" height="16px" viewBox="-66 94 64 64" enable-background="new -66 94 64 64" xml:space="preserve"> <path fill="#E6535E" d="M-61.4,158h18.3V94h-18.3V158z M-24.9,94v64h18.3V94H-24.9z"/> </svg>',left:-25,top:25,parent:this.innerContainer}),this.resetIntervalButton=bannerboy.createElement({innerHTML:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="24px" height="24px" viewBox="7 -7 24 24" enable-background="new 7 -7 24 24" xml:space="preserve"> <path fill="#E6535E" d="M20-4c-5,0-9,4-9,9H8l3.9,3.9L12,9l4-4h-3c0-3.9,3.1-7,7-7s7,3.1,7,7s-3.1,7-7,7c-1.9,0-3.7-0.8-4.9-2.1 l-1.4,1.4C15.3,13,17.5,14,20,14c5,0,9-4,9-9S25-4,20-4z M19,1v5l4.3,2.5L24,7.3l-3.5-2.1V1H19z"/> </svg> ',left:-31,top:55,opacity:.3,parent:this.innerContainer}),this.createTweensVisualization(),this.activeInterval=bannerboy.createElement({background:"#FFF",width:"100%",height:"100%",pointerEvents:"none",opacity:.1,parent:this.innerContainer});var o=bannerboy.createElement({background:"#34f27b",width:1,height:"100%",parent:this.innerContainer}),l=bannerboy.createElement({innerHTML:'<svg version="1.1" id="BB_firstPointHead" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="10px" height="10px" viewBox="0 0 10 10" enable-background="new 0 0 10 10" xml:space="preserve"> <circle fill="#34F27B" cx="5" cy="5" r="5"/> </svg>',x:"-50%",y:"-50%",parent:o});l.intervalPoint=0;var h=(document.getElementById("BB_firstPointHead"),bannerboy.createElement({background:"#34f27b",width:1,height:"100%",parent:this.innerContainer})),d=bannerboy.createElement({innerHTML:'<svg version="1.1" id="BB_secondPointHead" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="10px" height="10px" viewBox="0 0 10 10" enable-background="new 0 0 10 10" xml:space="preserve"> <circle fill="#34F27B" cx="5" cy="5" r="5"/> </svg>',x:"-50%",y:"-50%",parent:h});l.intervalPoint=1;document.getElementById("BB_secondPointHead");this.intervalPointsElements=[o,h];var p=localStorage.getItem(this.name);this.intervalPoints=p?p.split(" "):[0,1],this.intervalPointsElements[0].set({left:this.intervalPoints[0]*this.width}),this.intervalPointsElements[1].set({left:this.intervalPoints[1]*this.width}),l.addEventListener("mouseenter",this.mouseEnterIntervalHead),l.addEventListener("mousedown",function(e){r.mouseDownOnIntervalPoint(e)}),l.addEventListener("mouseleave",this.mouseLeaveIntervalHead),d.addEventListener("mouseenter",this.mouseEnterIntervalHead),d.addEventListener("mousedown",function(e){r.mouseDownOnIntervalPoint(e)}),d.addEventListener("mouseleave",this.mouseLeaveIntervalHead),this.calculateInterval(),TweenLite.set(this.activeInterval,{left:this.intervalPoints[0]*this.width,width:(this.intervalPoints[1]-this.intervalPoints[0])*this.width}),(this.intervalPoints[0]>0||this.intervalPoints[1]<1)&&this.resetIntervalButton.set({opacity:1}),window.addEventListener("resize",function(){r.width=parseInt(window.getComputedStyle(r.innerContainer).width);for(var e=0;e<r.labelElements.length;e++)r.labelElements[e].set({left:r.width*(r.labelElements[e].time/r.timeline.duration())});r.updateTweensVisualization(),TweenLite.set(r.intervalPointsElements[0],{left:r.intervalPoints[0]*r.width}),TweenLite.set(r.intervalPointsElements[1],{left:r.intervalPoints[1]*r.width}),TweenLite.set(r.activeInterval,{left:r.intervalPoints[0]*r.width,width:(r.intervalPoints[1]-r.intervalPoints[0])*r.width})}),this.container.addEventListener("mousedown",function(e){if(e.stopPropagation(),r.mouseX=r.getMouseX(e),r.currentHandlePos=r.mouseX,r.dragging=!0,bannerboy.scrubberController.keyDown("shift")){r.settingInterval=!0;var t=r.mouseX;TweenLite.set([r.intervalPointsElements[0],r.intervalPointsElements[1],r.activeInterval],{left:t})}}),this.pauseButton.addEventListener("mousedown",function(e){e.stopPropagation(),r.pause()}),this.playButton.addEventListener("mousedown",function(e){e.stopPropagation(),r.play()}),this.resetIntervalButton.addEventListener("mousedown",function(e){console.log("resetInterval"),e.stopPropagation(),TweenLite.set(r.intervalPointsElements[0],{left:0}),TweenLite.set(r.intervalPointsElements[1],{left:r.width}),TweenLite.set(r.resetIntervalButton,{opacity:.3}),r.calculateInterval(),TweenLite.set(r.activeInterval,{left:r.intervalPoints[0]*r.width,width:(r.intervalPoints[1]-r.intervalPoints[0])*r.width}),localStorage.setItem(r.name,r.intervalPoints[0]+" "+r.intervalPoints[1])}),window.addEventListener("mouseup",function(){r.dragging=!1,r.mouseX=r.getMouseX(event),(r.settingInterval||r.settingIntervalHead)&&(localStorage.setItem(r.name,r.intervalPoints[0]+" "+r.intervalPoints[1]),r.settingInterval=!1,r.settingIntervalHead=!1)}),window.addEventListener("mousemove",function(e){e.stopPropagation(),r.mouseX=r.getMouseX(e),r.currentHandlePos=r.mouseX,r.settingInterval&&(TweenLite.set(r.intervalPointsElements[1],{left:r.currentHandlePos}),TweenLite.set(r.resetIntervalButton,{opacity:1}),r.calculateInterval(),TweenLite.set(r.activeInterval,{left:r.intervalPoints[0]*r.width,width:(r.intervalPoints[1]-r.intervalPoints[0])*r.width})),r.settingIntervalHead&&(TweenLite.set(r.currentMovingIntervalHead,{left:r.currentHandlePos}),TweenLite.set(r.resetIntervalButton,{opacity:1}),r.calculateInterval(),TweenLite.set(r.activeInterval,{left:r.intervalPoints[0]*r.width,width:(r.intervalPoints[1]-r.intervalPoints[0])*r.width}))})},bannerboy.Scrubber.prototype.getSmallestIntervalPoint=function(){for(var e=this.width,t=0;t<this.intervalPointsElements.length;t++)e=this.intervalPointsElements[t].get("left")<e?this.intervalPointsElements[t].get("left"):e;return e},bannerboy.Scrubber.prototype.getHighestIntervalPoint=function(){for(var e=0,t=0;t<this.intervalPointsElements.length;t++)e=this.intervalPointsElements[t].get("left")>e?this.intervalPointsElements[t].get("left"):e;return e},bannerboy.Scrubber.prototype.calculateInterval=function(){this.intervalPoints[0]=this.getSmallestIntervalPoint()/this.width,this.intervalPoints[1]=this.getHighestIntervalPoint()/this.width},bannerboy.Scrubber.prototype.mouseDownOnIntervalPoint=function(e){e.stopPropagation(),this.settingIntervalHead=!0,this.currentMovingIntervalHead=e.target.parentNode.parentNode.parentNode},bannerboy.Scrubber.prototype.mouseEnterIntervalHead=function(e){e.stopPropagation();var t=e.target.childNodes[0];TweenLite.to(t,.1,{scale:3,transformOrigin:"bottom center"})},bannerboy.Scrubber.prototype.mouseLeaveIntervalHead=function(e){e.stopPropagation();var t=e.target.childNodes[0];TweenLite.to(t,.1,{scale:1,transformOrigin:"bottom center"})},bannerboy.Scrubber.prototype.getMouseX=function(e){return bannerboy.utils.clamp(e.clientX-bannerboy.scrubberController.controlsWidth,0,this.width)},bannerboy.Scrubber.prototype.pause=function(){this.pauseButton.set({display:"none"}),this.playButton.set({display:"block"}),this.timeline.isActive()&&this.timeline.pause()},bannerboy.Scrubber.prototype.play=function(){this.pauseButton.set({display:"block"}),this.playButton.set({display:"none"}),this.timeline.isActive()||this.timeline.play()},bannerboy.Scrubber.prototype.update=function(){this.dragging?(this.timeProgress=this.currentHandlePos/this.width,this.timeline.progress(this.timeProgress)):(this.currentHandlePos=this.width*this.timeline.progress(),!bannerboy.utils.inRange(this.timeline.progress(),this.intervalPoints[0],this.intervalPoints[1])&&this.timeline.isActive()&&this.timeline.progress(this.intervalPoints[0])),TweenLite.set(this.handle,{x:this.currentHandlePos}),this.timeElement.textContent=Math.round(10*this.timeline.time())/10,this.timeline.isActive()||this.paused?this.timeline.isActive()&&this.paused&&(this.paused=!1,this.play()):(this.paused=!0,this.pause())},bannerboy.Scrubber.prototype.updateTweensVisualization=function(){for(var e=0;e<this.children.length;e++){var t=this.children[e],n=this.childrenElements[e],i=t.startTime(),r=t.duration()/this.timeline.duration(),s=i/this.timeline.duration()*this.width,a=r*this.width;n.set({left:s,width:a}),"function"==typeof t.target&&(console.log(t.target.name),n.set({width:15}))}},bannerboy.Scrubber.prototype.createTweensVisualization=function(){for(var e=[],t=0,n=bannerboy.scrubberController.scrubberHeight,i=0;i<this.children.length;i++){var r=this.children[i];"function"!=typeof r.target&&e.push(r)}for(var s=0;s<this.children.length;s++){var a=this.children[s];if("___invisible"!=a.alias){var o=a.startTime(),l=a.duration()/this.timeline.duration(),h=o/this.timeline.duration()*this.width,d=l*this.width,p=n/e.length,c=bannerboy.createElement({backgroundColor:"#000",left:h,top:p*t,width:d,height:p,opacity:.4,parent:this.innerContainer}),u=bannerboy.createElement({width:"100%",height:"100%",border:"1px solid #FFF",boxSizing:"border-box",parent:c}),b=bannerboy.createElement({fontFamily:"Helvetica Neue",fontSize:9,color:"#FFF",padding:"1px 0 0 3px",parent:c});"function"==typeof a.target?(console.log(a.target.name),c.set({backgroundColor:"#E6535E",height:15,width:15,borderRadius:"100% 100% 100% 0",rotation:-45,opacity:1,color:"#000",top:-10,x:"-40%"}),u.set({border:"0px"}),b.set({left:"50%",x:"-50%",top:"50%",y:"-50%",padding:"",rotation:45,color:"#FFF"}),b.innerHTML=a.target.name||"f"):void 0===a.target?(b.innerHTML=a.alias||"timeline",t++):(b.innerHTML=a.alias||"tween",t++),this.childrenElements.push(c)}}};